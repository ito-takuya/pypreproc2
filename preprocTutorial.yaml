# List of Parameters for Preprocessing

################ Section 1 ###################
# Execution block commands.  Either True or False:
# Indicate which nodes you'd like to include in the pipeline
Nodes : 
    # Indicate the order you want to execute blocks - if you know what you're doing, you can add your own blocks (just add additional number - value pairs).  If you add your own nodes, make sure they are indented.

    ######## CURRENT LIST OF AVAILABLE NODES: #########

    # NODES: prepareMPRAGE, prepareEPI, sliceTimeCorrection, concatenateRuns, talairachAlignment, checkMotionParams, createGMMask, createWMMask, createVentricleMask, timeSeriesExtraction, spatialSmoothing, runGLM, groupAnalysis

    # Prepares the anatomical MRPAGE image; also runs freesurfer unless specified otherwise
    0 : PrepareMPRAGE
    # Prepares the EPI images
    1 : PrepareEPI
    # Runs slice time correction on the epi images. Make sure you know what the acquisition pattern is for this command!
    2 : SliceTimeCorrection
    # Concatenates all the functional runs into a single run
    3 : ConcatenateRuns
    # Talairach transforms the anatomical, functional, epi images to a template (MNI_EPI template)
    4 : TalairachAlignment
    # Checks the motion parameters
    5 : CheckMotionParams
    # Creates a gray matter mask using Freesurfer output
    6 : CreateGMMask
    # Creates a white matter mask using Freesurfer output
    7 : CreateWMMask
    # Creates a ventricle mask using Freesurfer output
    8 : CreateVentricleMask
    # Extracts the time series using the gray, white, and ventricle masks
    9 : TimeSeriesExtraction
    # Smooths the epi/functional images according to the FWHMSmoothing parameter below
    10 : SpatialSmoothing
    # Runs a GLM analysis on final, spatially smoothed output (single subject). If 'True', will most likely need to edit certain parameters in AFNI's command.
    11 : RunGLM
    # Run a group analysis running a two-factor ANOVA; if 'True', will need to edit certain parameters for this function
    12 : GroupAnalysis

    # CUSTOM COMMANDS:
    # If there are custom commands you want to include in the pipeline, just add them as a standard string. For example, if you wanted to run a 3dresample on the input EPI, it would go as follows:
    # 5 :  
    #     input : '%nextInputFilename' # This should be nextInputFilename, unless you're using a file not within the pipeline (or you know exactly what you're doing)
    #     output : 'resampled_%nextInputFilename'
    #     insertOutputAsNextInput : True #This is used only if you will process this output again WITHIN THIS PIPELINE.  If not, leave as 'None'. Default should be None
    #     cmd : '3dresample -dxyz 3.0 3.0 3.0 -inset %input -prefix %output'

# Indicate which nodes you want to run in the pipeline.  The default is to run all nodes, but if this is the first time running the pipeline, I suggest you run each node at a time. If you just want to run a single node, just put a single number (indicating the order in the above Nodes)
runNodes : [11]


###
# Parameters below aren't exactly nodes, but rather, they are sub-nodes that tell the pipeline whether or not to do extra steps or not.
# Is this HCP data?
hcpData : False
# If False, will skip Freesurfer. Typically this should be 'True'
runFreesurfer : False



################ Section 2 ###################
# Main data parameter set up; defaults are set to the ColePreprocTutorial dataset.
# Indicate the Analysis name of this project:
AnalysisName : 'Block'
# Indicate list of subjects with strings, e.g., 'subj1', 'subj2', etc.
listOfSubjects : ['401']
# Indicate the number of runs per subject
runsPerSubj : 10
# Base directory of the study; Curr
basedir : '/Volumes/Drobot/scratchdisk/taku_pypreproc2/'
# scripts directory
scriptsDir : '/Volumes/Drobot/scratchdisk/taku_pypreproc2/scripts/'
# atlas directory - should not need to change this
atlasAnat : '/Applications/afni/MNI152_1mm_uni+tlrc' # 1mm template for multiband (2mm for regular)
atlasEPI : '/Applications/afni/MNI_EPI+tlrc' # 2mm template for multiband, 3mm for regular# Location to AFNI's binary files - should not need to change this
AFNI_loc : '/Applications/afni/afni'
# Location to Freesurfer's binary files - should not need to change this
FS_loc : '/Applications/freesurfer/bin/freesurfer'
# Indicate the TR in seconds for the scan
TR : '1s' 
# Indicate the number of TRs per run. #### EDIT FEATURE, to make sure you can enable runs with different TR lengths.
numTRs : 528
# Indicate the smoothing parameter you want. 
FWHMSmoothing : 6
# Indicate teh acquisition order. For Siemens TRIO (standard EPI sequence): alt+z when you have an odd number of slices, alt+z2 when you have an even number of slices.  'None' for multiband data.
tpattern : 'alt+z'
# Indicate the number of TRs you would like to skip for each functional run. Leave at 0 if you don't want to exclude any TRs.
numTRsToSkip : 0


################ Section 3 ###################
############################ #Edit for future. Need to be able to automatically compute/evaluate subjfMRIDirs, etc.
# Subject raw data directory to all SCAN files containing DICOMs.  Subject IDs are indicated by the delimiter '%s'
subjRawDataDir : '/Volumes/Drobot/docshare/colelabpreproctutorial/assignment1/rawdata/%s/'
# Indicate the full path to the DICOMs (is a sub directory of subjRawDataDir)
subjDicomDir : '/Volumes/Drobot/docshare/colelabpreproctutorial/assignment1/rawdata/%s/*.dcm'
# Indicate where the freesurfer output should be, ideally in subjDir + 'freesurfer/'
freesurferDir : '/Volumes/Drobot/docshare/colelabpreproctutorial/freesurfer/%s/'
# Subject output directory
subjDir : '/Volumes/Drobot/scratchdisk/taku_pypreproc2/%s/'
# stimulus file directory (behavioral encodings)
stimFileDir : '/Volumes/Drobot/docshare/colelabpreproctutorial/assignment2/timingfiles/'
# Indicate the subject fMRI directory
subjfMRIDir : '/Volumes/Drobot/scratchdisk/taku_pypreproc2/%s/fMRI/'
# Indicate the subject Mask directory
subjMaskDir : '/Volumes/Drobot/scratchdisk/taku_pypreproc2/%s/masks/'
# Indicate the subject analysis directory (typically should be a subdir of subjfMRIDir)
subjAnalysisDir : '/Volumes/Drobot/scratchdisk/taku_pypreproc2/%s/fMRI/subjAnalysis/'


# Look in the raw data directory and observe all the various directories (should be numbered 1 through how ever many scans there were).  Find the directory containing the T1/anatomical scan.  If you're unsure, look inside 'subjRawDataDir'
T1_image : 'sagittal_mprage_256x256.5'
# exclude slice time correction for now.
epi_series : ['AssocMemRunX10_320x320.7', 'AssocMemRunX10_320x320.8', 'AssocMemRunX10_320x320.9', 'AssocMemRunX10_320x320.10', 'AssocMemRunX10_320x320.11', 'AssocMemRunX10_320x320.12','AssocMemRunX10_320x320.13', 'AssocMemRunX10_320x320.14', 'AssocMemRunX10_320x320.15', 'AssocMemRunX10_320x320.16']#, 'cmrr_mbep2d_bold_2mm_MB12_TR529msec_9', 'cmrr_mbep2d_bold_2mm_MB6_TR1sec_11']
# Process the EPI runs separately?  You cannot use concatenate runs block if you do this. Default should be False.  If you set this option to False, the pipeline can't handle running more than 10 EPI scans separately at once, so please break them up into parts.
runEPIsSeparate : False 
# Default FS output name for segmentation
fs_input : 'aseg.mgz'
# Number of processes you want to use
nproc : 1

# Ouput Log file:
# Default get time and date
logname : '/Volumes/Drobot/scratchdisk/taku_pypreproc2/%s/%s_taku.log'

#############################################################################################################
## GLM parameters ##
GLM :
    # Must indicate type. Either 'Activation' or 'rsfcMRI'
    type : 'Activation'
    # Default is already set.  Don't change unless you know exactly what you're doing.
    input : None 
    # If you're running scans separately, leave this as None
    concat : True
    # polort (A for activation, 1 for rsfcMRI)
    polort : A
    # Motion regressors are set by default below to the first 6 stim times, so do not change unless necessary:
    motionregressors : 
        1 : "allruns_motion_params.1D'[0]'"
        2 : "allruns_motion_params.1D'[1]'"
        3 : "allruns_motion_params.1D'[2]'"
        4 : "allruns_motion_params.1D'[3]'"
        5 : "allruns_motion_params.1D'[4]'"
        6 : "allruns_motion_params.1D'[5]'"
    # Indicate the stimulus timing files in AFNI format - only indicate the file name, since it will automatically search the task stimulus files in 'stimFileDir'.  
    stimtimes : 
        # indicate the file, followed by the label you'd like to associate with this stimulus
        1 : ["stime_%s_stimfile_AssocMemBlocks_CombStrength_EV1_Block_PairEnc.1D.01.1D 'BLOCK(54,1)'", 'PairEnc']

        2 : ["stime_%s_stimfile_AssocMemBlocks_CombStrength_EV2_Block_AudVisRet.1D.01.1D 'BLOCK(54,1)'",'AudVisRet']

        3 : ["stime_%s_stimfile_AssocMemBlocks_CombStrength_EV3_Block_VisAudRet.1D.01.1D 'BLOCK(54,1)'",'VisAudRet']

        4 : ["stime_%s_stimfile_AssocMemBlocks_CombStrength_EV4_Block_AuditoryCont.1D.01.1D 'BLOCK(54,1)'", 'AuditoryCont']


        5 : ["stime_%s_stimfile_AssocMemBlocks_CombStrength_EV5_Block_VisualCont.1D.01.1D 'BLOCK(54,1)'", 'VisualCont']

    # enter the parameter for gltsym. Otherwise, leave it blank.
    gltsym : "-gltsym 'SYM: AuditoryCont -VisualCont' -glt_label 1 AudVsVisCont"
    # Don't compute statistic v FDR (default: True for rsfcMRI, False for activation)
    noFDR : True
    # Label True if you want each stimulus to have a F-statistic. Default is True
    fout : True
    # Label True if you want each stimulus to have a T-statistic. Default is True
    tout : True
    # Give the label of the residual error time series. Otherwise leave it blank
    errts : #'NuissanceResid_Resids'


